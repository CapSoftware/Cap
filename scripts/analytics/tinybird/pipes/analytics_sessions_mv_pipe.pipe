NODE "analytics_sessions_mv_node"
DESCRIPTION >
    Materialized view that denormalizes browser/device metadata per session.
SQL >
	SELECT
		tenant_id,
		toDate(timestamp) AS date,
		session_id,
		coalesce(nullIf(browser, ''), 'unknown') AS browser,
		coalesce(nullIf(device, ''), 'desktop') AS device,
		coalesce(nullIf(os, ''), 'unknown') AS os
	FROM analytics_events
	WHERE action = 'page_hit'

TYPE MATERIALIZED
DATASOURCE analytics_sessions_mv
