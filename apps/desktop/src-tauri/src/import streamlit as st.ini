import streamlit as st
from pdf2docx import Converter
import os

# เบเบฑเปเบเบเปเบฒเปเปเบฒเปเบงเบฑเบ
st.set_page_config(page_title="Lao PDF Converter", layout="centered")

st.title("๐ เบฅเบฐเบเบปเบเปเบเบ PDF เปเบเบฑเบ Word (เบเบฒเบชเบฒเบฅเบฒเบง)")
st.write("เปเบเบเปเบเบฅเปเปเบซเปเบเบฒเบก, เบฎเบฑเบเบชเบฒเบฎเบนเบเปเบเบ เปเบฅเบฐ เปเบเปเปเบเปเบเป")

# เบชเปเบงเบเบญเบฑเบเปเบซเบฅเบเปเบเบฅเป
uploaded_file = st.file_uploader("เปเบฅเบทเบญเบเปเบเบฅเป PDF", type="pdf")

if uploaded_file is not None:
    # เบชเปเบฒเบเบเบธเปเบกเปเบเบเปเบเบฅเป
    if st.button("เปเบฅเบตเปเบกเปเบเบเปเบเบฅเปเบเบฑเบเบเบต"):
        with st.spinner('เบเบณเบฅเบฑเบเบเบฐเบกเบงเบเบเบปเบ... เบเบฐเบฅเบธเบเบฒเบฅเปเบเปเบฒ'):
            # 1. เบเบฑเบเบเบถเบเปเบเบฅเป PDF เบเบปเปเบงเบเบฒเบง
            with open("temp_input.pdf", "wb") as f:
                f.write(uploaded_file.getbuffer())
            
            # 2. เบเบฑเปเบเบเบทเปเปเบเบฅเป Word เบเบตเปเบเบฐเบชเปเบฒเบ
            output_docx = "Converted_Document.docx"
            
            try:
                # 3. เปเบเปเบเบปเบงเปเบเบเบเบตเปเบเปเบฝเบงเบเบฒเบ (pdf2docx)
                cv = Converter("temp_input.pdf")
                cv.convert(output_docx, start=0, end=None) # เปเบเบเบเบธเบเปเปเบฒ
                cv.close()

                # 4. เบชเปเบฒเบเบเบธเปเบกเบเบฒเบงเปเบซเบฅเบ
                with open(output_docx, "rb") as word_file:
                    st.download_button(
                        label="๐ฅ เบเบฒเบงเปเบซเบฅเบเปเบเบฅเป Word เบเบญเบเบเปเบฒเบ",
                        data=word_file,
                        file_name="converted_by_expert.docx",
                        mime="application/vnd.openxmlformats-officedocument.wordprocessingml.document"
                    )
                st.success("เปเบเบเปเบเบฅเปเบชเบณเปเบฅเบฑเบเปเบฅเปเบง! เบเปเบฒเบเบชเบฒเบกเบฒเบเบเบฒเบงเปเบซเบฅเบ เปเบฅเบฐ เปเบเปเปเบเปเบเปเปเบฅเบตเบ.")
                
            except Exception as e:
                st.error(f"เปเบเบตเบเบเปเปเบเบดเบเบเบฒเบ: {e}")
            
            # เบฅเบปเบเปเบเบฅเปเบเบตเปเปเบซเบเบทเปเบญเบญเบญเบ
            if os.path.exists("temp_input.pdf"): os.remove("temp_input.pdf")